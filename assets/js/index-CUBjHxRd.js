import{d as A,i as p,ai as E,U as v,r as s,o as V,c as C,t as N,Y as F,a as T,b as a,w as d,e as y,u as P,aj as R,ad as U,B as j,O as I,_ as K}from"./index-CDeestZe.js";const Y={class:"card filter"},G={key:0,class:"title sle"},H={class:"search"},J={class:"el-tree-node__label"},L=A({name:"TreeFilter"}),Q=A({...L,props:{requestApi:{},data:{},title:{},id:{default:"id"},label:{default:"label"},multiple:{type:Boolean,default:!1},defaultValue:{}},emits:["change"],setup(B,{expose:x,emit:M}){const l=B,S={children:"children",label:l.label},i=p(),f=p([]),m=p([]),h=p(),b=()=>{l.multiple?h.value=Array.isArray(l.defaultValue)?l.defaultValue:[l.defaultValue]:h.value=typeof l.defaultValue=="string"?l.defaultValue:""};E(async()=>{if(b(),l.requestApi){const{data:e}=await l.requestApi();f.value=e,m.value=[{id:"",[l.label]:"全部"},...e]}}),v(()=>l.defaultValue,()=>I(()=>b()),{deep:!0,immediate:!0}),v(()=>l.data,()=>{var e;(e=l.data)!=null&&e.length&&(f.value=l.data,m.value=[{id:"",[l.label]:"全部"},...l.data])},{deep:!0,immediate:!0});const _=p("");v(_,e=>{i.value.filter(e)});const q=(e,t,o)=>{if(!e)return!0;let n=o.parent,c=[o.label],u=1;for(;u<o.level;)c=[...c,n.label],n=n.parent,u++;return c.some(k=>k.indexOf(e)!==-1)},g=e=>{var o;let t=(o=i.value)==null?void 0:o.store.nodesMap;if(t)for(const n in t)t.hasOwnProperty(n)&&(t[n].expanded=e)},w=M,D=e=>{l.multiple||w("change",e[l.id])},O=()=>{var e;w("change",(e=i.value)==null?void 0:e.getCheckedKeys())};return x({treeData:f,treeAllData:m,treeRef:i}),(e,t)=>{const o=s("el-input"),n=s("More"),c=s("el-icon"),u=s("el-dropdown-item"),k=s("el-dropdown-menu"),$=s("el-dropdown"),z=s("el-scrollbar");return V(),C("div",Y,[e.title?(V(),C("h4",G,N(e.title),1)):F("",!0),T("div",H,[a(o,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=r=>_.value=r),placeholder:"输入关键字进行过滤",clearable:""},null,8,["modelValue"]),a($,{trigger:"click"},{dropdown:d(()=>[a(k,null,{default:d(()=>[a(u,{onClick:t[1]||(t[1]=r=>g(!0))},{default:d(()=>[y("展开全部")]),_:1}),a(u,{onClick:t[2]||(t[2]=r=>g(!1))},{default:d(()=>[y("折叠全部")]),_:1})]),_:1})]),default:d(()=>[a(c,{size:"20"},{default:d(()=>[a(n)]),_:1})]),_:1})]),a(z,{style:j({height:e.title?"calc(100% - 95px)":"calc(100% - 56px)"})},{default:d(()=>[a(P(R),{ref_key:"treeRef",ref:i,"default-expand-all":"","node-key":e.id,data:e.multiple?f.value:m.value,"show-checkbox":e.multiple,"check-strictly":!1,"current-node-key":e.multiple?"":h.value,"highlight-current":!e.multiple,"expand-on-click-node":!1,"check-on-click-node":e.multiple,props:S,"filter-node-method":q,"default-checked-keys":e.multiple?h.value:[],onNodeClick:D,onCheck:O},{default:d(r=>[T("span",J,[U(e.$slots,"default",{row:r},()=>[y(N(r.node.label),1)],!0)])]),_:3},8,["node-key","data","show-checkbox","current-node-key","highlight-current","check-on-click-node","default-checked-keys"])]),_:3},8,["style"])])}}}),X=K(Q,[["__scopeId","data-v-c47061e2"]]);export{X as T};
